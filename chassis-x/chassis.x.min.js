/**
  * v1.0.42 generated on: Tue Aug 30 2016 23:31:24 GMT+0000 (UTC)
  * Copyright (c) 2014-2016, Ecor Ventures LLC. All Rights Reserved. See LICENSE (BSD).
  */
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();if(window.NGNX=window.NGNX||{},window.NGNX.DATA=window.NGNX.DATA||{},!NGN.DATA.Proxy||!NGN.NET)throw new Error("NGN.DATA.Proxy & NGN.NET are required for NGN.DATA.HttpProxy.");if(window.NGNX.DATA.HttpProxy=function(e){e=e||{},this.constructor(e);var t=this;Object.defineProperties(this,{headers:NGN.define(!0,!0,!1,e.headers||{}),options:NGN._get(function(){var e={url:this.url,headers:this.headers};return this.token&&(e.accessToken=this.token),this.username&&(e.username=this.username),this.password&&(e.password=this.password),this.username&&this.password&&(e.withCredentials=!0),e}),save:NGN.define(!0,!1,!1,function(e,n){"function"==typeof url&&(n=e,e="");var r=0,s=function(e,s){return function(o){r++,200!==o.status&&201!==o.status&&NGN.emit("save.error",{message:o.responseText,status:o.status,action:e,model:s}),r===t.actions.create.length+t.actions.update.length+t.actions["delete"].length&&n&&n()}},o=this.options;o.url+=e||"",this.actions.create.forEach(function(e){o.json=e.data,NGN.NET.post(o,s("create",e))}),this.actions.update.forEach(function(e){o.url+="/"+e.id,o.json=e.data,NGN.NET.put(o,s("update",e))}),this.actions["delete"].forEach(function(e){o.url+="/"+e.id,NGN.NET["delete"](o,s("delete",e))})}),fetch:NGN.define(!0,!1,!1,function(e,n){var r=this.options;r.url+=e||"",NGN.NET.get(r,function(e){var r=e.responseText;"string"==typeof r&&(r=JSON.parse(r)),r instanceof Array&&t.store.reload(r),n&&n()})})})},NGN.inherit(NGN.DATA.Proxy,NGNX.DATA.HttpProxy),NGN){NGN.global.NGNX=NGN.global.NGNX||{};var Driver=function(){function e(t){var n=this;_classCallCheck(this,e),t=t||{},Object.defineProperties(this,{scope:NGN["const"](t.namespace||null),references:NGN.privateconst(t.references||{}),ref:NGN["private"]({}),datastores:NGN["const"](t.stores||{}),events:NGN["private"]([]),templates:NGN.privateconst(t.templates||{}),dataevents:NGN.privateconst(["record.create","record.delete","record.duplicate","record.update","record.expired","record.restored","record.purged","index.create","index.delete","filter.create","filter.remove"]),id:NGN.privateconst(NGN.coalesce(t.namespace,NGN.DATA.util.GUID()).replace(/[^A-Za-z0-9]/gi,""))}),Object.keys(this.references).forEach(function(e){var t=e;e=n.id+"-"+e,void 0!==NGN.ref[e]&&null!==NGN.ref[e]||(NGN.ref.create(e,n.references[t]),Object.defineProperty(n.ref,t,NGN.get(function(){return NGN.ref[e]})))}),null!==this.scope&&Object.keys(this.datastores).forEach(function(e){n.scopeStoreEvents(e)})}return _createClass(e,[{key:"render",value:function(e,t,n,r,s){var o=this;if(!this.templates.hasOwnProperty(e))return void console.warn("The Driver does not have a reference to a template called %c"+e.trim()+"%c.",NGN.css,"");if("object"!==("undefined"==typeof t?"undefined":_typeof(t)))return void console.warn("The data provided to the renderer could not be processed because it is not a key/value object.",t);if("function"==typeof n)return void NGN.NET.template(this.templates[e],t,n);if("string"==typeof n){var i=n;if(n=document.querySelector(n),null===n)return void console.warn("%c"+i+"%c is not a valid selector or the referenced parent DOM element could not be found.",NGN.css,"")}r=(r||"beforeend").toLowerCase(),NGN.NET.template(this.templates[e],t,function(e){NGN.hasOwnProperty("DOM")?NGN.DOM.svg.update(e,function(){o.adjustedRender(n,e,r,s)}):o.adjustedRender(n,e,r,s)})}},{key:"adjustedRender",value:function(e,t,n,r){if(["beforebegin","afterbegin","afterend"].indexOf(n.trim().toLowerCase())<0)e.appendChild(t),this.templateRendered(t),r&&r(t);else{switch(e.insertAdjacentElement(n,t),n){case"beforebegin":this.templateRendered(e.previousSibling);break;case"afterend":this.templateRendered(e.nextSibling);break;case"afterbegin":this.templateRendered(e.firstChild);break;default:this.templateRendered(e.lastChild)}r&&r(t)}}},{key:"templateRendered",value:function(e){NGN.BUS.emit(this.scope+"template.render",e),NGN.BUS.emit("template.render",e)}},{key:"addStore",value:function(e,t){var n=this;this.datastores.hasOwnProperty(e)&&(null!==this.scope&&this.dataevents.forEach(function(e){NGN.BUS.off(n.scope+e)}),console.warn("Driver already had a reference to %c"+e+"%c, which has been overwritten.",NGN.css,"")),this.datastores[e]=t,this.scopeStoreEvents(e)}},{key:"scopeStoreEvents",value:function(e,t){var n=this;t=NGN.coalesce(t,!1);var r=this;null!==this.scope?!function(){var t=null===n.scope?"NONE":n.scope.substr(n.scope.length-1,1);n.dataevents.forEach(function(n){r.datastores[e].on(n,function(){var s=NGN.slice(arguments);[" ","-",".","_","+",":"].indexOf(t)>=0?s.unshift(r.scope+e+t+n):s.unshift(r.scope+e+n),NGN.BUS.emit.apply(NGN.BUS,s)})})}():t||console.warn("Driver.scopeStoreEvents called without a defined namespace.")}},{key:"on",value:function(){var e=arguments[0];return NGN.BUS?void(this.events.indexOf(e)>=0?NGN.BUS.on.apply(NGN.BUS,arguments):console.warn("%c"+e+"%c is not a supported event for this Driver.",NGN.css,"")):void console.warn("%cNGNX.Driver.on('"+e+"', ...)%c will not work because NGN.BUS is not available.",NGN.css,"")}},{key:"pool",value:function(e,t){"object"===("undefined"==typeof e?"undefined":_typeof(e))&&(t=e,e="");var n=(this.scope+e).trim();n=n.length>0?n:null,NGN.BUS.pool(n,t)}},{key:"emit",value:function(){arguments[0]=this.scope+arguments[0],NGN.BUS.emit.apply(NGN.BUS,arguments)}},{key:"store",get:function(){return this.datastores}}]),e}();NGNX.Driver=Driver}else console.error("NGN not found.");if(NGN?window.NGN.BUS?NGN.NET?(window.NGNX=window.NGNX||{},window.NGNX.Loader=function(e,t){e=e||{};var n=this;Object.defineProperties(this,{async:NGN.define(!0,!0,!1,e.async||[]),sync:NGN.define(!0,!0,!1,e.sync||[])}),this.async=Array.isArray(this.async)?this.async:[this.async],this.sync=Array.isArray(this.sync)?this.sync:[this.sync];var r={sync:this.sync,async:this.async},s=function o(e){NGN.NET["import"](e.shift(),function(){e.length>0&&o(e)})};r.sync.length>0&&s(r.sync),this.async.length>0?NGN.NET["import"](this.async,function(e){setTimeout(function(){"function"==typeof t?t(n.sync.concat(e)):NGN.BUS.emit(t,n.sync.concat(n.async))},5)}):setTimeout(function(){"function"==typeof t?t(n.sync.concat(n.async)):NGN.BUS.emit(t,n.sync.concat(n.async))},5)}):console.warn("NGNX.Loader is not available because NGN.NET was not found."):console.warn("NGNX.Loader is not available because NGN.BUS was not found."):console.error("NGN not found."),window.NGN.BUS){window.NGNX=window.NGNX||{},Object.defineProperty(NGNX,"statechangerecorded",NGN["public"](!1)),NGN.BUS.on("state.change",function(e){NGN.BUS.emit("state."+(e?"visible":"hidden"))});var statehandler=function(){NGNX.statechangerecorded||(NGNX.statechangerecorded=!0,setTimeout(function(){NGNX.statechangerecorded=!1},25),NGN.BUS.emit("state.change","visible"===document.visibilityState))};document.addEventListener("visibilitychange",statehandler),document.addEventListener("beforeunload",statehandler),document.addEventListener("pagehide",statehandler)}else console.warn("State management is inactive because NGN.BUS was not found.");